{"version":3,"file":"tester.js","sourceRoot":"","sources":["../src/tester.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {ModelViewerElement} from '@google/model-viewer';\nimport {SimpleDropzone} from 'simple-dropzone';\n\nconst viewer = document.getElementById('loading-demo') as ModelViewerElement;\n\nconst inputElement = document.querySelector('#input');\nconst dropControl = new SimpleDropzone(viewer, inputElement);\ndropControl.on('drop', ({files}: any) => load(files));\n\n(['src', 'environmentImage'] as Array<'src'|'environmentImage'>)\n    .forEach((property) => {\n      document.getElementById(`${property}`)!.addEventListener(\n          'input', (event) => {\n            viewer[property] = (event.target as HTMLInputElement).value;\n            if (viewer.environmentImage === '') {\n              useSkybox.disabled = true;\n              useSkybox.checked = false;\n              viewer.skyboxImage = null;\n            } else {\n              useSkybox.disabled = false;\n            }\n            if (useSkybox.checked) {\n              viewer.skyboxImage = viewer.environmentImage;\n            }\n            if (property === 'src') {\n              resetModel();\n            }\n          });\n    });\n\nfunction resetModel() {\n  viewer.reveal = 'auto';\n  viewer.dismissPoster();\n  downloadButton.disabled = true;\n  displayButton.disabled = true;\n  // remove hotspots\n  while (viewer.firstChild) {\n    viewer.removeChild(viewer.firstChild);\n  }\n}\n\nconst useSkybox = document.getElementById('useSkybox') as HTMLInputElement;\nuseSkybox.addEventListener('change', (_event) => {\n  if (useSkybox.checked) {\n    viewer.skyboxImage = viewer.environmentImage;\n  } else {\n    viewer.skyboxImage = null;\n  }\n});\n\n(['exposure', 'shadowIntensity', 'shadowSoftness'] as\n Array<'exposure'|'shadowIntensity'|'shadowSoftness'>)\n    .forEach((property) => {\n      const input = document.getElementById(`${property}`) as HTMLInputElement;\n      const output =\n          document.getElementById(`${property}Value`) as HTMLInputElement;\n      input.addEventListener('input', (event) => {\n        output.value = (event.target as HTMLInputElement).value;\n        viewer[property] = parseFloat(output.value);\n      });\n      output.addEventListener('input', (event) => {\n        input.value = (event.target as HTMLInputElement).value;\n        viewer[property] = parseFloat(output.value);\n      });\n    });\n\n(['autoRotate'] as Array<'autoRotate'>).forEach((property) => {\n  const checkbox = document.getElementById(`${property}`) as HTMLInputElement;\n  checkbox.addEventListener('change', (_event) => {\n    viewer[property] = checkbox.checked;\n  });\n});\n\nlet posterUrl = '';\nconst a = document.createElement('a');\nconst downloadButton = document.getElementById('download') as HTMLButtonElement;\nconst displayButton = document.getElementById('display') as HTMLButtonElement;\ndownloadButton.disabled = true;\ndisplayButton.disabled = true;\nconst orbitString = document.getElementById('cameraOrbit') as HTMLDivElement;\n\nexport async function createPoster() {\n  const orbit = viewer.getCameraOrbit();\n  orbitString.textContent = `${orbit.theta}rad ${orbit.phi}rad auto`;\n  viewer.fieldOfView = 'auto';\n  viewer.jumpCameraToGoal();\n  await new Promise(resolve => requestAnimationFrame(() => resolve()));\n  URL.revokeObjectURL(posterUrl);\n  const blob = await viewer.toBlob({mimeType: 'image/png', idealAspect: true});\n  posterUrl = URL.createObjectURL(blob);\n  downloadButton.disabled = false;\n  displayButton.disabled = false;\n}\n\nexport function reloadScene() {\n  viewer.poster = posterUrl;\n  viewer.reveal = 'interaction';\n  viewer.cameraOrbit = orbitString.textContent!;\n  viewer.jumpCameraToGoal();\n  const src = viewer.src;\n  viewer.src = null;\n  viewer.src = src;\n}\n\nexport function downloadPoster() {\n  a.href = posterUrl;\n  a.download = 'poster.png';\n  a.click();\n}\n\nexport function addHotspot() {\n  viewer.addEventListener('click', onClick);\n}\n\nlet hotspotCounter = 0;\nlet selectedHotspot: HTMLElement|undefined = undefined;\n\nexport function removeHotspot() {\n  if (selectedHotspot != null) {\n    viewer.removeChild(selectedHotspot);\n  }\n}\n\nfunction select(hotspot: HTMLElement) {\n  for (let i = 0; i < viewer.children.length; i++) {\n    viewer.children[i].classList.remove('selected');\n  }\n  hotspot.classList.add('selected');\n  selectedHotspot = hotspot;\n}\n\nfunction onClick(event: MouseEvent) {\n  const rect = viewer.getBoundingClientRect();\n  const x = event.clientX - rect.left;\n  const y = event.clientY - rect.top;\n  const positionAndNormal = viewer.positionAndNormalFromPoint(x, y);\n\n  if (positionAndNormal == null) {\n    console.log('no hit result: mouse = ', x, ', ', y);\n    return;\n  }\n  const {position, normal} = positionAndNormal;\n\n  const hotspot = document.createElement('button');\n  hotspot.slot = `hotspot-${hotspotCounter++}`;\n  hotspot.classList.add('hotspot');\n  hotspot.dataset.position = position.toString();\n  if (normal != null) {\n    hotspot.dataset.normal = normal.toString();\n  }\n  viewer.appendChild(hotspot);\n\n  select(hotspot);\n  hotspot.addEventListener('click', () => {select(hotspot)});\n\n  const label = document.createElement('div');\n  label.classList.add('annotation');\n  label.textContent =\n      'data-position:\\r\\n' + position + '\\r\\ndata-normal:\\r\\n' + normal;\n  hotspot.appendChild(label);\n\n  viewer.removeEventListener('click', onClick);\n}\n\n(self as any).createPoster = createPoster;\n(self as any).reloadScene = reloadScene;\n(self as any).downloadPoster = downloadPoster;\n(self as any).addHotspot = addHotspot;\n(self as any).removeHotspot = removeHotspot;\n\nfunction load(fileMap: Map<string, File>) {\n  let rootPath: string;\n  Array.from(fileMap).forEach(([path, file]) => {\n    const filename = file.name.toLowerCase();\n    if (filename.match(/\\.(gltf|glb)$/)) {\n      const blobURLs: Array<string> = [];\n      rootPath = path.replace(file.name, '');\n\n      ModelViewerElement.mapURLs((url: string) => {\n        const index = url.lastIndexOf('/');\n\n        const normalizedURL =\n            rootPath + url.substr(index + 1).replace(/^(\\.?\\/)/, '');\n\n        if (fileMap.has(normalizedURL)) {\n          const blob = fileMap.get(normalizedURL);\n          const blobURL = URL.createObjectURL(blob);\n          blobURLs.push(blobURL);\n          return blobURL;\n        }\n\n        return url;\n      });\n\n      viewer.addEventListener('load', () => {\n        blobURLs.forEach(URL.revokeObjectURL);\n      });\n\n      const fileURL =\n          typeof file === 'string' ? file : URL.createObjectURL(file);\n      viewer.src = fileURL;\n      resetModel();\n    }\n  });\n\n  if (fileMap.size === 1) {\n    const file = fileMap.values().next().value;\n    const filename = file.name.toLowerCase();\n    if (filename.match(/\\.(hdr)$/)) {\n      viewer.environmentImage = URL.createObjectURL(file) + '#.hdr';\n    } else if (filename.match(/\\.(png|jpg)$/)) {\n      viewer.environmentImage = URL.createObjectURL(file);\n    }\n    if (useSkybox.checked) {\n      viewer.skyboxImage = viewer.environmentImage;\n    }\n  }\n}\n"]}